!function(t,n){"function"==typeof define&&define.amd?define(["jquery"],function(e){return n(t,e)}):"object"==typeof exports?n(t,require("jquery")):n(t,t.jQuery||t.Zepto)}(this,function(t,n){"use strict";function e(t){if(E&&"none"===t.css("animation-name")&&"none"===t.css("-webkit-animation-name")&&"none"===t.css("-moz-animation-name")&&"none"===t.css("-o-animation-name")&&"none"===t.css("-ms-animation-name"))return 0;var n,e,a,i,o=t.css("animation-duration")||t.css("-webkit-animation-duration")||t.css("-moz-animation-duration")||t.css("-o-animation-duration")||t.css("-ms-animation-duration")||"0s",s=t.css("animation-delay")||t.css("-webkit-animation-delay")||t.css("-moz-animation-delay")||t.css("-o-animation-delay")||t.css("-ms-animation-delay")||"0s",r=t.css("animation-iteration-count")||t.css("-webkit-animation-iteration-count")||t.css("-moz-animation-iteration-count")||t.css("-o-animation-iteration-count")||t.css("-ms-animation-iteration-count")||"1";for(o=o.split(", "),s=s.split(", "),r=r.split(", "),i=0,e=o.length,n=Number.NEGATIVE_INFINITY;i<e;i++)a=parseFloat(o[i])*parseInt(r[i],10)+parseFloat(s[i]),a>n&&(n=a);return n}function a(){if(n(document.body).height()<=n(window).height())return 0;var t,e,a=document.createElement("div"),i=document.createElement("div");return a.style.visibility="hidden",a.style.width="100px",document.body.appendChild(a),t=a.offsetWidth,a.style.overflow="scroll",i.style.width="100%",a.appendChild(i),e=i.offsetWidth,a.parentNode.removeChild(a),t-e}function i(){if(!N){var t,e,i=n("html"),o=c("is-locked");i.hasClass(o)||(e=n(document.body),t=parseInt(e.css("padding-right"),10)+a(),e.css("padding-right",t+"px"),i.addClass(o))}}function o(){if(!N){var t,e,i=n("html"),o=c("is-locked");i.hasClass(o)&&(e=n(document.body),t=parseInt(e.css("padding-right"),10)-a(),e.css("padding-right",t+"px"),i.removeClass(o))}}function s(t,n,e,a){var i=c("is",n),o=[c("is",$.CLOSING),c("is",$.OPENING),c("is",$.CLOSED),c("is",$.OPENED)].join(" ");t.$bg.removeClass(o).addClass(i),t.$overlay.removeClass(o).addClass(i),t.$wrapper.removeClass(o).addClass(i),t.$modal.removeClass(o).addClass(i),t.state=n,!e&&t.$modal.trigger({type:n,reason:a},[{reason:a}])}function r(t,a,i){var o=0,s=function(t){t.target===this&&o++},r=function(t){t.target===this&&0===--o&&(n.each(["$bg","$overlay","$wrapper","$modal"],function(t,n){i[n].off(v+" "+C)}),a())};n.each(["$bg","$overlay","$wrapper","$modal"],function(t,n){i[n].on(v,s).on(C,r)}),t(),0===e(i.$bg)&&0===e(i.$overlay)&&0===e(i.$wrapper)&&0===e(i.$modal)&&(n.each(["$bg","$overlay","$wrapper","$modal"],function(t,n){i[n].off(v+" "+C)}),a())}function d(t){t.state!==$.CLOSED&&(n.each(["$bg","$overlay","$wrapper","$modal"],function(n,e){t[e].off(v+" "+C)}),t.$bg.removeClass(t.settings.modifier),t.$overlay.removeClass(t.settings.modifier).hide(),t.$wrapper.hide(),o(),s(t,$.CLOSED,!0))}function l(t){var n,e,a,i,o={};for(t=t.replace(/\s*:\s*/g,":").replace(/\s*,\s*/g,","),n=t.split(","),i=0,e=n.length;i<e;i++)n[i]=n[i].split(":"),a=n[i][1],("string"==typeof a||a instanceof String)&&(a="true"===a||"false"!==a&&a),("string"==typeof a||a instanceof String)&&(a=isNaN(a)?a:+a),o[n[i][0]]=a;return o}function c(){for(var t=h,n=0;n<arguments.length;++n)t+="-"+arguments[n];return t}function m(){var t,e,a=location.hash.replace("#","");if(a){try{e=n('[data-remodal-id="'+a+'"]')}catch(i){}e&&e.length&&(t=n[g].lookup[e.data(g)],t&&t.settings.hashTracking&&t.open())}else u&&u.state===$.OPENED&&u.settings.hashTracking&&u.close()}function p(t,e){var a=n(document.body),i=a,o=this;o.settings=n.extend({},O,e),o.index=n[g].lookup.push(o)-1,o.state=$.CLOSED,o.$overlay=n("."+c("overlay")),null!==o.settings.appendTo&&o.settings.appendTo.length&&(i=n(o.settings.appendTo)),o.$overlay.length||(o.$overlay=n("<div>").addClass(c("overlay")+" "+c("is",$.CLOSED)).hide(),i.append(o.$overlay)),o.$bg=n("."+c("bg")).addClass(c("is",$.CLOSED)),o.$modal=t.addClass(h+" "+c("is-initialized")+" "+o.settings.modifier+" "+c("is",$.CLOSED)).attr("tabindex","-1"),o.$wrapper=n("<div>").addClass(c("wrapper")+" "+o.settings.modifier+" "+c("is",$.CLOSED)).hide().append(o.$modal),i.append(o.$wrapper),o.$wrapper.on("click."+h,'[data-remodal-action="close"]',function(t){t.preventDefault(),o.close()}),o.$wrapper.on("click."+h,'[data-remodal-action="cancel"]',function(t){t.preventDefault(),o.$modal.trigger(y.CANCELLATION),o.settings.closeOnCancel&&o.close(y.CANCELLATION)}),o.$wrapper.on("click."+h,'[data-remodal-action="confirm"]',function(t){t.preventDefault(),o.$modal.trigger(y.CONFIRMATION),o.settings.closeOnConfirm&&o.close(y.CONFIRMATION)}),o.$wrapper.on("click."+h,function(t){var e=n(t.target);e.hasClass(c("wrapper"))&&o.settings.closeOnOutsideClick&&o.close()})}var u,f,g="remodal",h=t.REMODAL_GLOBALS&&t.REMODAL_GLOBALS.NAMESPACE||g,v=n.map(["animationstart","webkitAnimationStart","MSAnimationStart","oAnimationStart"],function(t){return t+"."+h}).join(" "),C=n.map(["animationend","webkitAnimationEnd","MSAnimationEnd","oAnimationEnd"],function(t){return t+"."+h}).join(" "),O=n.extend({hashTracking:!0,closeOnConfirm:!0,closeOnCancel:!0,closeOnEscape:!0,closeOnOutsideClick:!0,modifier:"",appendTo:null},t.REMODAL_GLOBALS&&t.REMODAL_GLOBALS.DEFAULTS),$={CLOSING:"closing",CLOSED:"closed",OPENING:"opening",OPENED:"opened"},y={CONFIRMATION:"confirmation",CANCELLATION:"cancellation"},E=function(){var t=document.createElement("div").style;return void 0!==t.animationName||void 0!==t.WebkitAnimationName||void 0!==t.MozAnimationName||void 0!==t.msAnimationName||void 0!==t.OAnimationName}(),N=/iPad|iPhone|iPod/.test(navigator.platform);p.prototype.open=function(){var t,e=this;e.state!==$.OPENING&&e.state!==$.CLOSING&&(t=e.$modal.attr("data-remodal-id"),t&&e.settings.hashTracking&&(f=n(window).scrollTop(),location.hash=t),u&&u!==e&&d(u),u=e,i(),e.$bg.addClass(e.settings.modifier),e.$overlay.addClass(e.settings.modifier).show(),e.$wrapper.show().scrollTop(0),r(function(){s(e,$.OPENING)},function(){s(e,$.OPENED)},e))},p.prototype.close=function(t){var e=this;e.state!==$.OPENING&&e.state!==$.CLOSING&&(e.settings.hashTracking&&e.$modal.attr("data-remodal-id")===location.hash.substr(1)&&(location.hash="",n(window).scrollTop(f)),r(function(){s(e,$.CLOSING,!1,t)},function(){e.$bg.removeClass(e.settings.modifier),e.$overlay.removeClass(e.settings.modifier).hide(),e.$wrapper.hide(),o(),s(e,$.CLOSED,!1,t)},e))},p.prototype.getState=function(){return this.state},p.prototype.destroy=function(){var t,e=n[g].lookup;d(this),this.$wrapper.remove(),delete e[this.index],t=n.grep(e,function(t){return!!t}).length,0===t&&(this.$overlay.remove(),this.$bg.removeClass(c("is",$.CLOSING)+" "+c("is",$.OPENING)+" "+c("is",$.CLOSED)+" "+c("is",$.OPENED)))},n[g]={lookup:[]},n.fn[g]=function(t){var e,a;return this.each(function(i,o){a=n(o),null==a.data(g)?(e=new p(a,t),a.data(g,e.index),e.settings.hashTracking&&a.attr("data-remodal-id")===location.hash.substr(1)&&e.open()):e=n[g].lookup[a.data(g)]}),e},n(document).ready(function(){n(document).on("click","[data-remodal-target]",function(t){t.preventDefault();var e=t.currentTarget,a=e.getAttribute("data-remodal-target"),i=n('[data-remodal-id="'+a+'"]');n[g].lookup[i.data(g)].open()}),n(document).find("."+h).each(function(t,e){var a=n(e),i=a.data("remodal-options");i?("string"==typeof i||i instanceof String)&&(i=l(i)):i={},a[g](i)}),n(document).on("keydown."+h,function(t){u&&u.settings.closeOnEscape&&u.state===$.OPENED&&27===t.keyCode&&u.close()}),n(window).on("hashchange."+h,m)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlbW9kYWwuanMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJkZWZpbmUiLCJhbWQiLCIkIiwiZXhwb3J0cyIsInJlcXVpcmUiLCJqUXVlcnkiLCJaZXB0byIsInRoaXMiLCJnbG9iYWwiLCJnZXRBbmltYXRpb25EdXJhdGlvbiIsIiRlbGVtIiwiSVNfQU5JTUFUSU9OIiwiY3NzIiwibWF4IiwibGVuIiwibnVtIiwiaSIsImR1cmF0aW9uIiwiZGVsYXkiLCJpdGVyYXRpb25Db3VudCIsInNwbGl0IiwibGVuZ3RoIiwiTnVtYmVyIiwiTkVHQVRJVkVfSU5GSU5JVFkiLCJwYXJzZUZsb2F0IiwicGFyc2VJbnQiLCJnZXRTY3JvbGxiYXJXaWR0aCIsImRvY3VtZW50IiwiYm9keSIsImhlaWdodCIsIndpbmRvdyIsIndpZHRoTm9TY3JvbGwiLCJ3aWR0aFdpdGhTY3JvbGwiLCJvdXRlciIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lciIsInN0eWxlIiwidmlzaWJpbGl0eSIsIndpZHRoIiwiYXBwZW5kQ2hpbGQiLCJvZmZzZXRXaWR0aCIsIm92ZXJmbG93IiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwibG9ja1NjcmVlbiIsIklTX0lPUyIsInBhZGRpbmdSaWdodCIsIiRib2R5IiwiJGh0bWwiLCJsb2NrZWRDbGFzcyIsIm5hbWVzcGFjaWZ5IiwiaGFzQ2xhc3MiLCJhZGRDbGFzcyIsInVubG9ja1NjcmVlbiIsInJlbW92ZUNsYXNzIiwic2V0U3RhdGUiLCJpbnN0YW5jZSIsInN0YXRlIiwiaXNTaWxlbnQiLCJyZWFzb24iLCJuZXdTdGF0ZSIsImFsbFN0YXRlcyIsIlNUQVRFUyIsIkNMT1NJTkciLCJPUEVOSU5HIiwiQ0xPU0VEIiwiT1BFTkVEIiwiam9pbiIsIiRiZyIsIiRvdmVybGF5IiwiJHdyYXBwZXIiLCIkbW9kYWwiLCJ0cmlnZ2VyIiwidHlwZSIsInN5bmNXaXRoQW5pbWF0aW9uIiwiZG9CZWZvcmVBbmltYXRpb24iLCJkb0FmdGVyQW5pbWF0aW9uIiwicnVubmluZ0FuaW1hdGlvbnNDb3VudCIsImhhbmRsZUFuaW1hdGlvblN0YXJ0IiwiZSIsInRhcmdldCIsImhhbmRsZUFuaW1hdGlvbkVuZCIsImVhY2giLCJpbmRleCIsImVsZW1OYW1lIiwib2ZmIiwiQU5JTUFUSU9OU1RBUlRfRVZFTlRTIiwiQU5JTUFUSU9ORU5EX0VWRU5UUyIsIm9uIiwiaGFsdCIsInNldHRpbmdzIiwibW9kaWZpZXIiLCJoaWRlIiwicGFyc2VPcHRpb25zIiwic3RyIiwiYXJyIiwidmFsIiwib2JqIiwicmVwbGFjZSIsIlN0cmluZyIsImlzTmFOIiwicmVzdWx0IiwiTkFNRVNQQUNFIiwiYXJndW1lbnRzIiwiaGFuZGxlSGFzaENoYW5nZUV2ZW50IiwiaWQiLCJsb2NhdGlvbiIsImhhc2giLCJlcnIiLCJQTFVHSU5fTkFNRSIsImxvb2t1cCIsImRhdGEiLCJoYXNoVHJhY2tpbmciLCJvcGVuIiwiY3VycmVudCIsImNsb3NlIiwiUmVtb2RhbCIsIm9wdGlvbnMiLCIkYXBwZW5kVG8iLCJyZW1vZGFsIiwiZXh0ZW5kIiwiREVGQVVMVFMiLCJwdXNoIiwiYXBwZW5kVG8iLCJhcHBlbmQiLCJhdHRyIiwicHJldmVudERlZmF1bHQiLCJTVEFURV9DSEFOR0VfUkVBU09OUyIsIkNBTkNFTExBVElPTiIsImNsb3NlT25DYW5jZWwiLCJDT05GSVJNQVRJT04iLCJjbG9zZU9uQ29uZmlybSIsIiR0YXJnZXQiLCJjbG9zZU9uT3V0c2lkZUNsaWNrIiwic2Nyb2xsVG9wIiwiUkVNT0RBTF9HTE9CQUxTIiwibWFwIiwiZXZlbnROYW1lIiwiY2xvc2VPbkVzY2FwZSIsInVuZGVmaW5lZCIsImFuaW1hdGlvbk5hbWUiLCJXZWJraXRBbmltYXRpb25OYW1lIiwiTW96QW5pbWF0aW9uTmFtZSIsIm1zQW5pbWF0aW9uTmFtZSIsIk9BbmltYXRpb25OYW1lIiwidGVzdCIsIm5hdmlnYXRvciIsInBsYXRmb3JtIiwicHJvdG90eXBlIiwic2hvdyIsInN1YnN0ciIsImdldFN0YXRlIiwiZGVzdHJveSIsImluc3RhbmNlQ291bnQiLCJyZW1vdmUiLCJncmVwIiwiZm4iLCJvcHRzIiwiZWxlbSIsInJlYWR5IiwiY3VycmVudFRhcmdldCIsImdldEF0dHJpYnV0ZSIsImZpbmQiLCJjb250YWluZXIiLCIkY29udGFpbmVyIiwia2V5Q29kZSJdLCJtYXBwaW5ncyI6IkNBQUMsU0FBVUEsRUFBTUMsR0FDTyxrQkFBWEMsU0FBeUJBLE9BQU9DLElBQ3pDRCxRQUFRLFVBQVcsU0FBU0UsR0FDMUIsTUFBT0gsR0FBUUQsRUFBTUksS0FFSyxnQkFBWkMsU0FDaEJKLEVBQVFELEVBQU1NLFFBQVEsV0FFdEJMLEVBQVFELEVBQU1BLEVBQUtPLFFBQVVQLEVBQUtRLFFBRW5DQyxLQUFNLFNBQVNDLEVBQVFOLEdBRXhCLFlBb0lBLFNBQVNPLEdBQXFCQyxHQUM1QixHQUNFQyxHQUNnQyxTQUFoQ0QsRUFBTUUsSUFBSSxtQkFDOEIsU0FBeENGLEVBQU1FLElBQUksMkJBQzJCLFNBQXJDRixFQUFNRSxJQUFJLHdCQUN5QixTQUFuQ0YsRUFBTUUsSUFBSSxzQkFDMEIsU0FBcENGLEVBQU1FLElBQUksc0JBRVYsTUFBTyxFQUdULElBcUJJQyxHQUNBQyxFQUNBQyxFQUNBQyxFQXhCQUMsRUFBV1AsRUFBTUUsSUFBSSx1QkFDdkJGLEVBQU1FLElBQUksK0JBQ1ZGLEVBQU1FLElBQUksNEJBQ1ZGLEVBQU1FLElBQUksMEJBQ1ZGLEVBQU1FLElBQUksMkJBQ1YsS0FFRU0sRUFBUVIsRUFBTUUsSUFBSSxvQkFDcEJGLEVBQU1FLElBQUksNEJBQ1ZGLEVBQU1FLElBQUkseUJBQ1ZGLEVBQU1FLElBQUksdUJBQ1ZGLEVBQU1FLElBQUksd0JBQ1YsS0FFRU8sRUFBaUJULEVBQU1FLElBQUksOEJBQzdCRixFQUFNRSxJQUFJLHNDQUNWRixFQUFNRSxJQUFJLG1DQUNWRixFQUFNRSxJQUFJLGlDQUNWRixFQUFNRSxJQUFJLGtDQUNWLEdBWUYsS0FMQUssRUFBV0EsRUFBU0csTUFBTSxNQUMxQkYsRUFBUUEsRUFBTUUsTUFBTSxN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RitDLEVBQVd2RCxHQUFhUSxLQUkxQm5ILEVBQUV5QixVQUFVNkQsR0FBRyxXQUFhYyxFQUFXLFNBQVN2QixHQUMxQ21DLEdBQVdBLEVBQVF4QixTQUFTZ0QsZUFBaUJ4QixFQUFRekQsUUFBVUssRUFBT0ksUUFBd0IsS0FBZGEsRUFBRXNGLFNBQ3BGbkQsRUFBUUMsVUFLWmpILEVBQUU0QixRQUFRMEQsR0FBRyxjQUFnQmMsRUFBV0UiLCJmaWxlIjoicmVtb2RhbC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiEoZnVuY3Rpb24ocm9vdCwgZmFjdG9yeSkge1xyXG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcclxuICAgIGRlZmluZShbJ2pxdWVyeSddLCBmdW5jdGlvbigkKSB7XHJcbiAgICAgIHJldHVybiBmYWN0b3J5KHJvb3QsICQpO1xyXG4gICAgfSk7XHJcbiAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcclxuICAgIGZhY3Rvcnkocm9vdCwgcmVxdWlyZSgnanF1ZXJ5JykpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBmYWN0b3J5KHJvb3QsIHJvb3QualF1ZXJ5IHx8IHJvb3QuWmVwdG8pO1xyXG4gIH1cclxufSkodGhpcywgZnVuY3Rpb24oZ2xvYmFsLCAkKSB7XHJcblxyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgLyoqXHJcbiAgICogTmFtZSBvZiB0aGUgcGx1Z2luXHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAY29uc3RcclxuICAgKiBAdHlwZSB7U3RyaW5nfVxyXG4gICAqL1xyXG4gIHZhciBQTFVHSU5fTkFNRSA9ICdyZW1vZGFsJztcclxuXHJcbiAgLyoqXHJcbiAgICogTmFtZXNwYWNlIGZvciBDU1MgYW5kIGV2ZW50c1xyXG4gICAqIEBwcml2YXRlXHJcbiAgICogQGNvbnN0XHJcbiAgICogQHR5cGUge1N0cmluZ31cclxuICAgKi9cclxuICB2YXIgTkFNRVNQQUNFID0gZ2xvYmFsLlJFTU9EQUxfR0xPQkFMUyAmJiBnbG9iYWwuUkVNT0RBTF9HTE9CQUxTLk5BTUVTUEFDRSB8fCBQTFVHSU5fTkFNRTtcclxuXHJcbiAgLyoqXHJcbiAgICogQW5pbWF0aW9uc3RhcnQgZXZlbnQgd2l0aCB2ZW5kb3IgcHJlZml4ZXNcclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEBjb25zdFxyXG4gICAqIEB0eXBlIHtTdHJpbmd9XHJcbiAgICovXHJcbiAgdmFyIEFOSU1BVElPTlNUQVJUX0VWRU5UUyA9ICQubWFwKFxyXG4gICAgWydhbmltYXRpb25zdGFydCcsICd3ZWJraXRBbmltYXRpb25TdGFydCcsICdNU0FuaW1hdGlvblN0YXJ0JywgJ29BbmltYXRpb25TdGFydCddLFxyXG5cclxuICAgIGZ1bmN0aW9uKGV2ZW50TmFtZSkge1xyXG4gICAgICByZXR1cm4gZXZlbnROYW1lICsgJy4nICsgTkFNRVNQQUNFO1xyXG4gICAgfVxyXG5cclxuICApLmpvaW4oJyAnKTtcclxuXHJcbiAgLyoqXHJcbiAgICogQW5pbWF0aW9uZW5kIGV2ZW50IHdpdGggdmVuZG9yIHByZWZpeGVzXHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAY29uc3RcclxuICAgKiBAdHlwZSB7U3RyaW5nfVxyXG4gICAqL1xyXG4gIHZhciBBTklNQVRJT05FTkRfRVZFTlRTID0gJC5tYXAoXHJcbiAgICBbJ2FuaW1hdGlvbmVuZCcsICd3ZWJraXRBbmltYXRpb25FbmQnLCAnTVNBbmltYXRpb25FbmQnLCAnb0FuaW1hdGlvbkVuZCddLFxyXG5cclxuICAgIGZ1bmN0aW9uKGV2ZW50TmFtZSkge1xyXG4gICAgICByZXR1cm4gZXZlbnROYW1lICsgJy4nICsgTkFNRVNQQUNFO1xyXG4gICAgfVxyXG5cclxuICApLmpvaW4oJyAnKTtcclxuXHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBzZXR0aW5nc1xyXG4gICAqIEBwcml2YXRlXHJcbiAgICogQGNvbnN0XHJcbiAgICogQHR5cGUge09iamVjdH1cclxuICAgKi9cclxuICB2YXIgREVGQVVMVFMgPSAkLmV4dGVuZCh7XHJcbiAgICBoYXNoVHJhY2tpbmc6IHRydWUsXHJcbiAgICBjbG9zZU9uQ29uZmlybTogdHJ1ZSxcclxuICAgIGNsb3NlT25DYW5jZWw6IHRydWUsXHJcbiAgICBjbG9zZU9uRXNjYXBlOiB0cnVlLFxyXG4gICAgY2xvc2VPbk91dHNpZGVDbGljazogdHJ1ZSxcclxuICAgIG1vZGlmaWVyOiAnJyxcclxuICAgIGFwcGVuZFRvOiBudWxsXHJcbiAgfSwgZ2xvYmFsLlJFTU9EQUxfR0xPQkFMUyAmJiBnbG9iYWwuUkVNT0RBTF9HTE9CQUxTLkRFRkFVTFRTKTtcclxuXHJcbiAgLyoqXHJcbiAgICogU3RhdGVzIG9mIHRoZSBSZW1vZGFsXHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAY29uc3RcclxuICAgKiBAZW51bSB7U3RyaW5nfVxyXG4gICAqL1xyXG4gIHZhciBTVEFURVMgPSB7XHJcbiAgICBDTE9TSU5HOiAnY2xvc2luZycsXHJcbiAgICBDTE9TRUQ6ICdjbG9zZWQnLFxyXG4gICAgT1BFTklORzogJ29wZW5pbmcnLFxyXG4gICAgT1BFTkVEOiAnb3BlbmVkJ1xyXG4gIH07XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlYXNvbnMgb2YgdGhlIHN0YXRlIGNoYW5nZS5cclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEBjb25zdFxyXG4gICAqIEBlbnVtIHtTdHJpbmd9XHJcbiAgICovXHJcbiAgdmFyIFNUQVRFX0NIQU5HRV9SRUFTT05TID0ge1xyXG4gICAgQ09ORklSTUFUSU9OOiAnY29uZmlybWF0aW9uJyxcclxuICAgIENBTkNFTExBVElPTjogJ2NhbmNlbGxhdGlvbidcclxuICB9O1xyXG5cclxuICAvKipcclxuICAgKiBJcyBhbmltYXRpb24gc3VwcG9ydGVkP1xyXG4gICAqIEBwcml2YXRlXHJcbiAgICogQGNvbnN0XHJcbiAgICogQHR5cGUge0Jvb2xlYW59XHJcbiAgICovXHJcbiAgdmFyIElTX0FOSU1BVElPTiA9IChmdW5jdGlvbigpIHtcclxuICAgIHZhciBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLnN0eWxlO1xyXG5cclxuICAgIHJldHVybiBzdHlsZS5hbmltYXRpb25OYW1lICE9PSB1bmRlZmluZWQgfHxcclxuICAgICAgc3R5bGUuV2Via2l0QW5pbWF0aW9uTmFtZSAhPT0gdW5kZWZpbmVkIHx8XHJcbiAgICAgIHN0eWxlLk1vekFuaW1hdGlvbk5hbWUgIT09IHVuZGVmaW5lZCB8fFxyXG4gICAgICBzdHlsZS5tc0FuaW1hdGlvbk5hbWUgIT09IHVuZGVmaW5lZCB8fFxyXG4gICAgICBzdHlsZS5PQW5pbWF0aW9uTmFtZSAhPT0gdW5kZWZpbmVkO1xyXG4gIH0pKCk7XHJcblxyXG4gIC8qKlxyXG4gICAqIElzIGlPUz9cclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEBjb25zdFxyXG4gICAqIEB0eXBlIHtCb29sZWFufVxyXG4gICAqL1xyXG4gIHZhciBJU19JT1MgPSAvaVBhZHxpUGhvbmV8aVBvZC8udGVzdChuYXZpZ2F0b3IucGxhdGZvcm0pO1xyXG5cclxuICAvKipcclxuICAgKiBDdXJyZW50IG1vZGFsXHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAdHlwZSB7UmVtb2RhbH1cclxuICAgKi9cclxuICB2YXIgY3VycmVudDtcclxuXHJcbiAgLyoqXHJcbiAgICogU2Nyb2xsYmFyIHBvc2l0aW9uXHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAdHlwZSB7TnVtYmVyfVxyXG4gICAqL1xyXG4gIHZhciBzY3JvbGxUb3A7XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgYW4gYW5pbWF0aW9uIGR1cmF0aW9uXHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAcGFyYW0ge2pRdWVyeX0gJGVsZW1cclxuICAgKiBAcmV0dXJucyB7TnVtYmVyfVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGdldEFuaW1hdGlvbkR1cmF0aW9uKCRlbGVtKSB7XHJcbiAgICBpZiAoXHJcbiAgICAgIElTX0FOSU1BVElPTiAmJlxyXG4gICAgICAkZWxlbS5jc3MoJ2FuaW1hdGlvbi1uYW1lJykgPT09ICdub25lJyAmJlxyXG4gICAgICAkZWxlbS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnKSA9PT0gJ25vbmUnICYmXHJcbiAgICAgICRlbGVtLmNzcygnLW1vei1hbmltYXRpb24tbmFtZScpID09PSAnbm9uZScgJiZcclxuICAgICAgJGVsZW0uY3NzKCctby1hbmltYXRpb24tbmFtZScpID09PSAnbm9uZScgJiZcclxuICAgICAgJGVsZW0uY3NzKCctbXMtYW5pbWF0aW9uLW5hbWUnKSA9PT0gJ25vbmUnXHJcbiAgICApIHtcclxuICAgICAgcmV0dXJuIDA7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGR1cmF0aW9uID0gJGVsZW0uY3NzKCdhbmltYXRpb24tZHVyYXRpb24nKSB8fFxyXG4gICAgICAkZWxlbS5jc3MoJy13ZWJraXQtYW5pbWF0aW9uLWR1cmF0aW9uJykgfHxcclxuICAgICAgJGVsZW0uY3NzKCctbW96LWFuaW1hdGlvbi1kdXJhdGlvbicpIHx8XHJcbiAgICAgICRlbGVtLmNzcygnLW8tYW5pbWF0aW9uLWR1cmF0aW9uJykgfHxcclxuICAgICAgJGVsZW0uY3NzKCctbXMtYW5pbWF0aW9uLWR1cmF0aW9uJykgfHxcclxuICAgICAgJzBzJztcclxuXHJcbiAgICB2YXIgZGVsYXkgPSAkZWxlbS5jc3MoJ2FuaW1hdGlvbi1kZWxheScpIHx8XHJcbiAgICAgICRlbGVtLmNzcygnLXdlYmtpdC1hbmltYXRpb24tZGVsYXknKSB8fFxyXG4gICAgICAkZWxlbS5jc3MoJy1tb3otYW5pbWF0aW9uLWRlbGF5JykgfHxcclxuICAgICAgJGVsZW0uY3NzKCctby1hbmltYXRpb24tZGVsYXknKSB8fFxyXG4gICAgICAkZWxlbS5jc3MoJy1tcy1hbmltYXRpb24tZGVsYXknKSB8fFxyXG4gICAgICAnMHMnO1xyXG5cclxuICAgIHZhciBpdGVyYXRpb25Db3VudCA9ICRlbGVtLmNzcygnYW5pbWF0aW9uLWl0ZXJhdGlvbi1jb3VudCcpIHx8XHJcbiAgICAgICRlbGVtLmNzcygnLXdlYmtpdC1hbmltYXRpb24taXRlcmF0aW9uLWNvdW50JykgfHxcclxuICAgICAgJGVsZW0uY3NzKCctbW96LWFuaW1hdGlvbi1pdGVyYXRpb24tY291bnQnKSB8fFxyXG4gICAgICAkZWxlbS5jc3MoJy1vLWFuaW1hdGlvbi1pdGVyYXRpb24tY291bnQnKSB8fFxyXG4gICAgICAkZWxlbS5jc3MoJy1tcy1hbmltYXRpb24taXRlcmF0aW9uLWNvdW50JykgfHxcclxuICAgICAgJzEnO1xyXG5cclxuICAgIHZhciBtYXg7XHJcbiAgICB2YXIgbGVuO1xyXG4gICAgdmFyIG51bTtcclxuICAgIHZhciBpO1xyXG5cclxuICAgIGR1cmF0aW9uID0gZHVyYXRpb24uc3BsaXQoJywgJyk7XHJcbiAgICBkZWxheSA9IGRlbGF5LnNwbGl0KCcsICcpO1xyXG4gICAgaXRlcmF0aW9uQ291bnQgPSBpdGVyYXRpb25Db3VudC5zcGxpdCgnLCAnKTtcclxuXHJcbiAgICAvLyBUaGUgJ2R1cmF0aW9uJyBzaXplIGlzIHRoZSBzYW1lIGFzIHRoZSAnZGVsYXknIHNpemVcclxuICAgIGZvciAoaSA9IDAsIGxlbiA9IGR1cmF0aW9uLmxlbmd0aCwgbWF4ID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgbnVtID0gcGFyc2VGbG9hdChkdXJhdGlvbltpXSkgKiBwYXJzZUludChpdGVyYXRpb25Db3VudFtpXSwgMTApICsgcGFyc2VGbG9hdChkZWxheVtpXSk7XHJcblxyXG4gICAgICBpZiAobnVtID4gbWF4KSB7XHJcbiAgICAgICAgbWF4ID0gbnVtO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG1heDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgYSBzY3JvbGxiYXIgd2lkdGhcclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEByZXR1cm5zIHtOdW1iZXJ9XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gZ2V0U2Nyb2xsYmFyV2lkdGgoKSB7XHJcbiAgICBpZiAoJChkb2N1bWVudC5ib2R5KS5oZWlnaHQoKSA8PSAkKHdpbmRvdykuaGVpZ2h0KCkpIHtcclxuICAgICAgcmV0dXJuIDA7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIG91dGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICB2YXIgaW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIHZhciB3aWR0aE5vU2Nyb2xsO1xyXG4gICAgdmFyIHdpZHRoV2l0aFNjcm9sbDtcclxuXHJcbiAgICBvdXRlci5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XHJcbiAgICBvdXRlci5zdHlsZS53aWR0aCA9ICcxMDBweCc7XHJcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG91dGVyKTtcclxuXHJcbiAgICB3aWR0aE5vU2Nyb2xsID0gb3V0ZXIub2Zmc2V0V2lkdGg7XHJcblxyXG4gICAgLy8gRm9yY2Ugc2Nyb2xsYmFyc1xyXG4gICAgb3V0ZXIuc3R5bGUub3ZlcmZsb3cgPSAnc2Nyb2xsJztcclxuXHJcbiAgICAvLyBBZGQgaW5uZXIgZGl2XHJcbiAgICBpbm5lci5zdHlsZS53aWR0aCA9ICcxMDAlJztcclxuICAgIG91dGVyLmFwcGVuZENoaWxkKGlubmVyKTtcclxuXHJcbiAgICB3aWR0aFdpdGhTY3JvbGwgPSBpbm5lci5vZmZzZXRXaWR0aDtcclxuXHJcbiAgICAvLyBSZW1vdmUgZGl2c1xyXG4gICAgb3V0ZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChvdXRlcik7XHJcblxyXG4gICAgcmV0dXJuIHdpZHRoTm9TY3JvbGwgLSB3aWR0aFdpdGhTY3JvbGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBMb2NrcyB0aGUgc2NyZWVuXHJcbiAgICogQHByaXZhdGVcclxuICAgKi9cclxuICBmdW5jdGlvbiBsb2NrU2NyZWVuKCkge1xyXG4gICAgaWYgKElTX0lPUykge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdmFyICRodG1sID0gJCgnaHRtbCcpO1xyXG4gICAgdmFyIGxvY2tlZENsYXNzID0gbmFtZXNwYWNpZnkoJ2lzLWxvY2tlZCcpO1xyXG4gICAgdmFyIHBhZGRpbmdSaWdodDtcclxuICAgIHZhciAkYm9keTtcclxuXHJcbiAgICBpZiAoISRodG1sLmhhc0NsYXNzKGxvY2tlZENsYXNzKSkge1xyXG4gICAgICAkYm9keSA9ICQoZG9jdW1lbnQuYm9keSk7XHJcblxyXG4gICAgICAvLyBaZXB0byBkb2VzIG5vdCBzdXBwb3J0ICctPScsICcrPScgaW4gdGhlIGBjc3NgIG1ldGhvZFxyXG4gICAgICBwYWRkaW5nUmlnaHQgPSBwYXJzZUludCgkYm9keS5jc3MoJ3BhZGRpbmctcmlnaHQnKSwgMTApICsgZ2V0U2Nyb2xsYmFyV2lkdGgoKTtcclxuXHJcbiAgICAgICRib2R5LmNzcygncGFkZGluZy1yaWdodCcsIHBhZGRpbmdSaWdodCArICdweCcpO1xyXG4gICAgICAkaHRtbC5hZGRDbGFzcyhsb2NrZWRDbGFzcyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVbmxvY2tzIHRoZSBzY3JlZW5cclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHVubG9ja1NjcmVlbigpIHtcclxuICAgIGlmIChJU19JT1MpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciAkaHRtbCA9ICQoJ2h0bWwnKTtcclxuICAgIHZhciBsb2NrZWRDbGFzcyA9IG5hbWVzcGFjaWZ5KCdpcy1sb2NrZWQnKTtcclxuICAgIHZhciBwYWRkaW5nUmlnaHQ7XHJcbiAgICB2YXIgJGJvZHk7XHJcblxyXG4gICAgaWYgKCRodG1sLmhhc0NsYXNzKGxvY2tlZENsYXNzKSkge1xyXG4gICAgICAkYm9keSA9ICQoZG9jdW1lbnQuYm9keSk7XHJcblxyXG4gICAgICAvLyBaZXB0byBkb2VzIG5vdCBzdXBwb3J0ICctPScsICcrPScgaW4gdGhlIGBjc3NgIG1ldGhvZFxyXG4gICAgICBwYWRkaW5nUmlnaHQgPSBwYXJzZUludCgkYm9keS5jc3MoJ3BhZGRpbmctcmlnaHQnKSwgMTApIC0gZ2V0U2Nyb2xsYmFyV2lkdGgoKTtcclxuXHJcbiAgICAgICRib2R5LmNzcygncGFkZGluZy1yaWdodCcsIHBhZGRpbmdSaWdodCArICdweCcpO1xyXG4gICAgICAkaHRtbC5yZW1vdmVDbGFzcyhsb2NrZWRDbGFzcyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXRzIGEgc3RhdGUgZm9yIGFuIGluc3RhbmNlXHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAcGFyYW0ge1JlbW9kYWx9IGluc3RhbmNlXHJcbiAgICogQHBhcmFtIHtTVEFURVN9IHN0YXRlXHJcbiAgICogQHBhcmFtIHtCb29sZWFufSBpc1NpbGVudCBJZiB0cnVlLCBSZW1vZGFsIGRvZXMgbm90IHRyaWdnZXIgZXZlbnRzXHJcbiAgICogQHBhcmFtIHtTdHJpbmd9IFJlYXNvbiBvZiBhIHN0YXRlIGNoYW5nZS5cclxuICAgKi9cclxuICBmdW5jdGlvbiBzZXRTdGF0ZShpbnN0YW5jZSwgc3RhdGUsIGlzU2lsZW50LCByZWFzb24pIHtcclxuXHJcbiAgICB2YXIgbmV3U3RhdGUgPSBuYW1lc3BhY2lmeSgnaXMnLCBzdGF0ZSk7XHJcbiAgICB2YXIgYWxsU3RhdGVzID0gW25hbWVzcGFjaWZ5KCdpcycsIFNUQVRFUy5DTE9TSU5HKSxcclxuICAgICAgICAgICAgICAgICAgICAgbmFtZXNwYWNpZnkoJ2lzJywgU1RBVEVTLk9QRU5JTkcpLFxyXG4gICAgICAgICAgICAgICAgICAgICBuYW1lc3BhY2lmeSgnaXMnLCBTVEFURVMuQ0xPU0VEKSxcclxuICAgICAgICAgICAgICAgICAgICAgbmFtZXNwYWNpZnkoJ2lzJywgU1RBVEVTLk9QRU5FRCldLmpvaW4oJyAnKTtcclxuXHJcbiAgICBpbnN0YW5jZS4kYmdcclxuICAgICAgLnJlbW92ZUNsYXNzKGFsbFN0YXRlcylcclxuICAgICAgLmFkZENsYXNzKG5ld1N0YXRlKTtcclxuXHJcbiAgICBpbnN0YW5jZS4kb3ZlcmxheVxyXG4gICAgICAucmVtb3ZlQ2xhc3MoYWxsU3RhdGVzKVxyXG4gICAgICAuYWRkQ2xhc3MobmV3U3RhdGUpO1xyXG5cclxuICAgIGluc3RhbmNlLiR3cmFwcGVyXHJcbiAgICAgIC5yZW1vdmVDbGFzcyhhbGxTdGF0ZXMpXHJcbiAgICAgIC5hZGRDbGFzcyhuZXdTdGF0ZSk7XHJcblxyXG4gICAgaW5zdGFuY2UuJG1vZGFsXHJcbiAgICAgIC5yZW1vdmVDbGFzcyhhbGxTdGF0ZXMpXHJcbiAgICAgIC5hZGRDbGFzcyhuZXdTdGF0ZSk7XHJcblxyXG4gICAgaW5zdGFuY2Uuc3RhdGUgPSBzdGF0ZTtcclxuICAgICFpc1NpbGVudCAmJiBpbnN0YW5jZS4kbW9kYWwudHJpZ2dlcih7XHJcbiAgICAgIHR5cGU6IHN0YXRlLFxyXG4gICAgICByZWFzb246IHJlYXNvblxyXG4gICAgfSwgW3sgcmVhc29uOiByZWFzb24gfV0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3luY2hyb25pemVzIHdpdGggdGhlIGFuaW1hdGlvblxyXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGRvQmVmb3JlQW5pbWF0aW9uXHJcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZG9BZnRlckFuaW1hdGlvblxyXG4gICAqIEBwYXJhbSB7UmVtb2RhbH0gaW5zdGFuY2VcclxuICAgKi9cclxuICBmdW5jdGlvbiBzeW5jV2l0aEFuaW1hdGlvbihkb0JlZm9yZUFuaW1hdGlvbiwgZG9BZnRlckFuaW1hdGlvbiwgaW5zdGFuY2UpIHtcclxuICAgIHZhciBydW5uaW5nQW5pbWF0aW9uc0NvdW50ID0gMDtcclxuXHJcbiAgICB2YXIgaGFuZGxlQW5pbWF0aW9uU3RhcnQgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGlmIChlLnRhcmdldCAhPT0gdGhpcykge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgcnVubmluZ0FuaW1hdGlvbnNDb3VudCsrO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgaGFuZGxlQW5pbWF0aW9uRW5kID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICBpZiAoZS50YXJnZXQgIT09IHRoaXMpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICgtLXJ1bm5pbmdBbmltYXRpb25zQ291bnQgPT09IDApIHtcclxuXHJcbiAgICAgICAgLy8gUmVtb3ZlIGV2ZW50IGxpc3RlbmVyc1xyXG4gICAgICAgICQuZWFjaChbJyRiZycsICckb3ZlcmxheScsICckd3JhcHBlcicsICckbW9kYWwnXSwgZnVuY3Rpb24oaW5kZXgsIGVsZW1OYW1lKSB7XHJcbiAgICAgICAgICBpbnN0YW5jZVtlbGVtTmFtZV0ub2ZmKEFOSU1BVElPTlNUQVJUX0VWRU5UUyArICcgJyArIEFOSU1BVElPTkVORF9FVkVOVFMpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBkb0FmdGVyQW5pbWF0aW9uKCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgJC5lYWNoKFsnJGJnJywgJyRvdmVybGF5JywgJyR3cmFwcGVyJywgJyRtb2RhbCddLCBmdW5jdGlvbihpbmRleCwgZWxlbU5hbWUpIHtcclxuICAgICAgaW5zdGFuY2VbZWxlbU5hbWVdXHJcbiAgICAgICAgLm9uKEFOSU1BVElPTlNUQVJUX0VWRU5UUywgaGFuZGxlQW5pbWF0aW9uU3RhcnQpXHJcbiAgICAgICAgLm9uKEFOSU1BVElPTkVORF9FVkVOVFMsIGhhbmRsZUFuaW1hdGlvbkVuZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkb0JlZm9yZUFuaW1hdGlvbigpO1xyXG5cclxuICAgIC8vIElmIHRoZSBhbmltYXRpb24gaXMgbm90IHN1cHBvcnRlZCBieSBhIGJyb3dzZXIgb3IgaXRzIGR1cmF0aW9uIGlzIDBcclxuICAgIGlmIChcclxuICAgICAgZ2V0QW5pbWF0aW9uRHVyYXRpb24oaW5zdGFuY2UuJGJnKSA9PT0gMCAmJlxyXG4gICAgICBnZXRBbmltYXRpb25EdXJhdGlvbihpbnN0YW5jZS4kb3ZlcmxheSkgPT09IDAgJiZcclxuICAgICAgZ2V0QW5pbWF0aW9uRHVyYXRpb24oaW5zdGFuY2UuJHdyYXBwZXIpID09PSAwICYmXHJcbiAgICAgIGdldEFuaW1hdGlvbkR1cmF0aW9uKGluc3RhbmNlLiRtb2RhbCkgPT09IDBcclxuICAgICkge1xyXG5cclxuICAgICAgLy8gUmVtb3ZlIGV2ZW50IGxpc3RlbmVyc1xyXG4gICAgICAkLmVhY2goWyckYmcnLCAnJG92ZXJsYXknLCAnJHdyYXBwZXInLCAnJG1vZGFsJ10sIGZ1bmN0aW9uKGluZGV4LCBlbGVtTmFtZSkge1xyXG4gICAgICAgIGluc3RhbmNlW2VsZW1OYW1lXS5vZmYoQU5JTUFUSU9OU1RBUlRfRVZFTlRTICsgJyAnICsgQU5JTUFUSU9ORU5EX0VWRU5UUyk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgZG9BZnRlckFuaW1hdGlvbigpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2xvc2VzIGltbWVkaWF0ZWx5XHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAcGFyYW0ge1JlbW9kYWx9IGluc3RhbmNlXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gaGFsdChpbnN0YW5jZSkge1xyXG4gICAgaWYgKGluc3RhbmNlLnN0YXRlID09PSBTVEFURVMuQ0xPU0VEKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAkLmVhY2goWyckYmcnLCAnJG92ZXJsYXknLCAnJHdyYXBwZXInLCAnJG1vZGFsJ10sIGZ1bmN0aW9uKGluZGV4LCBlbGVtTmFtZSkge1xyXG4gICAgICBpbnN0YW5jZVtlbGVtTmFtZV0ub2ZmKEFOSU1BVElPTlNUQVJUX0VWRU5UUyArICcgJyArIEFOSU1BVElPTkVORF9FVkVOVFMpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaW5zdGFuY2UuJGJnLnJlbW92ZUNsYXNzKGluc3RhbmNlLnNldHRpbmdzLm1vZGlmaWVyKTtcclxuICAgIGluc3RhbmNlLiRvdmVybGF5LnJlbW92ZUNsYXNzKGluc3RhbmNlLnNldHRpbmdzLm1vZGlmaWVyKS5oaWRlKCk7XHJcbiAgICBpbnN0YW5jZS4kd3JhcHBlci5oaWRlKCk7XHJcbiAgICB1bmxvY2tTY3JlZW4oKTtcclxuICAgIHNldFN0YXRlKGluc3RhbmNlLCBTVEFURVMuQ0xPU0VELCB0cnVlKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBhcnNlcyBhIHN0cmluZyB3aXRoIG9wdGlvbnNcclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEBwYXJhbSBzdHJcclxuICAgKiBAcmV0dXJucyB7T2JqZWN0fVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHBhcnNlT3B0aW9ucyhzdHIpIHtcclxuICAgIHZhciBvYmogPSB7fTtcclxuICAgIHZhciBhcnI7XHJcbiAgICB2YXIgbGVuO1xyXG4gICAgdmFyIHZhbDtcclxuICAgIHZhciBpO1xyXG5cclxuICAgIC8vIFJlbW92ZSBzcGFjZXMgYmVmb3JlIGFuZCBhZnRlciBkZWxpbWl0ZXJzXHJcbiAgICBzdHIgPSBzdHIucmVwbGFjZSgvXFxzKjpcXHMqL2csICc6JykucmVwbGFjZSgvXFxzKixcXHMqL2csICcsJyk7XHJcblxyXG4gICAgLy8gUGFyc2UgYSBzdHJpbmdcclxuICAgIGFyciA9IHN0ci5zcGxpdCgnLCcpO1xyXG4gICAgZm9yIChpID0gMCwgbGVuID0gYXJyLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgIGFycltpXSA9IGFycltpXS5zcGxpdCgnOicpO1xyXG4gICAgICB2YWwgPSBhcnJbaV1bMV07XHJcblxyXG4gICAgICAvLyBDb252ZXJ0IGEgc3RyaW5nIHZhbHVlIGlmIGl0IGlzIGxpa2UgYSBib29sZWFuXHJcbiAgICAgIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJyB8fCB2YWwgaW5zdGFuY2VvZiBTdHJpbmcpIHtcclxuICAgICAgICB2YWwgPSB2YWwgPT09ICd0cnVlJyB8fCAodmFsID09PSAnZmFsc2UnID8gZmFsc2UgOiB2YWwpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDb252ZXJ0IGEgc3RyaW5nIHZhbHVlIGlmIGl0IGlzIGxpa2UgYSBudW1iZXJcclxuICAgICAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnIHx8IHZhbCBpbnN0YW5jZW9mIFN0cmluZykge1xyXG4gICAgICAgIHZhbCA9ICFpc05hTih2YWwpID8gK3ZhbCA6IHZhbDtcclxuICAgICAgfVxyXG5cclxuICAgICAgb2JqW2FycltpXVswXV0gPSB2YWw7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG9iajtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdlbmVyYXRlcyBhIHN0cmluZyBzZXBhcmF0ZWQgYnkgZGFzaGVzIGFuZCBwcmVmaXhlZCB3aXRoIE5BTUVTUEFDRVxyXG4gICAqIEBwcml2YXRlXHJcbiAgICogQHBhcmFtIHsuLi5TdHJpbmd9XHJcbiAgICogQHJldHVybnMge1N0cmluZ31cclxuICAgKi9cclxuICBmdW5jdGlvbiBuYW1lc3BhY2lmeSgpIHtcclxuICAgIHZhciByZXN1bHQgPSBOQU1FU1BBQ0U7XHJcblxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgcmVzdWx0ICs9ICctJyArIGFyZ3VtZW50c1tpXTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSGFuZGxlcyB0aGUgaGFzaGNoYW5nZSBldmVudFxyXG4gICAqIEBwcml2YXRlXHJcbiAgICogQGxpc3RlbnMgaGFzaGNoYW5nZVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGhhbmRsZUhhc2hDaGFuZ2VFdmVudCgpIHtcclxuICAgIHZhciBpZCA9IGxvY2F0aW9uLmhhc2gucmVwbGFjZSgnIycsICcnKTtcclxuICAgIHZhciBpbnN0YW5jZTtcclxuICAgIHZhciAkZWxlbTtcclxuXHJcbiAgICBpZiAoIWlkKSB7XHJcblxyXG4gICAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIGN1cnJlbnRseSBvcGVuZWQgbW9kYWwgYW5kIGFuaW1hdGlvbiB3YXMgY29tcGxldGVkXHJcbiAgICAgIGlmIChjdXJyZW50ICYmIGN1cnJlbnQuc3RhdGUgPT09IFNUQVRFUy5PUEVORUQgJiYgY3VycmVudC5zZXR0aW5ncy5oYXNoVHJhY2tpbmcpIHtcclxuICAgICAgICBjdXJyZW50LmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAvLyBDYXRjaCBzeW50YXggZXJyb3IgaWYgeW91ciBoYXNoIGlzIGJhZFxyXG4gICAgICB0cnkge1xyXG4gICAgICAgICRlbGVtID0gJChcclxuICAgICAgICAgICdbZGF0YS0nICsgUExVR0lOX05BTUUgKyAnLWlkPVwiJyArIGlkICsgJ1wiXSdcclxuICAgICAgICApO1xyXG4gICAgICB9IGNhdGNoIChlcnIpIHt9XHJcblxyXG4gICAgICBpZiAoJGVsZW0gJiYgJGVsZW0ubGVuZ3RoKSB7XHJcbiAgICAgICAgaW5zdGFuY2UgPSAkW1BMVUdJTl9OQU1FXS5sb29rdXBbJGVsZW0uZGF0YShQTFVHSU5fTkFNRSldO1xyXG5cclxuICAgICAgICBpZiAoaW5zdGFuY2UgJiYgaW5zdGFuY2Uuc2V0dGluZ3MuaGFzaFRyYWNraW5nKSB7XHJcbiAgICAgICAgICBpbnN0YW5jZS5vcGVuKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVtb2RhbCBjb25zdHJ1Y3RvclxyXG4gICAqIEBjb25zdHJ1Y3RvclxyXG4gICAqIEBwYXJhbSB7alF1ZXJ5fSAkbW9kYWxcclxuICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIFJlbW9kYWwoJG1vZGFsLCBvcHRpb25zKSB7XHJcbiAgICB2YXIgJGJvZHkgPSAkKGRvY3VtZW50LmJvZHkpO1xyXG4gICAgdmFyICRhcHBlbmRUbyA9ICRib2R5O1xyXG4gICAgdmFyIHJlbW9kYWwgPSB0aGlzO1xyXG5cclxuICAgIHJlbW9kYWwuc2V0dGluZ3MgPSAkLmV4dGVuZCh7fSwgREVGQVVMVFMsIG9wdGlvbnMpO1xyXG4gICAgcmVtb2RhbC5pbmRleCA9ICRbUExVR0lOX05BTUVdLmxvb2t1cC5wdXNoKHJlbW9kYWwpIC0gMTtcclxuICAgIHJlbW9kYWwuc3RhdGUgPSBTVEFURVMuQ0xPU0VEO1xyXG5cclxuICAgIHJlbW9kYWwuJG92ZXJsYXkgPSAkKCcuJyArIG5hbWVzcGFjaWZ5KCdvdmVybGF5JykpO1xyXG5cclxuICAgIGlmIChyZW1vZGFsLnNldHRpbmdzLmFwcGVuZFRvICE9PSBudWxsICYmIHJlbW9kYWwuc2V0dGluZ3MuYXBwZW5kVG8ubGVuZ3RoKSB7XHJcbiAgICAgICRhcHBlbmRUbyA9ICQocmVtb2RhbC5zZXR0aW5ncy5hcHBlbmRUbyk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFyZW1vZGFsLiRvdmVybGF5Lmxlbmd0aCkge1xyXG4gICAgICByZW1vZGFsLiRvdmVybGF5ID0gJCgnPGRpdj4nKS5hZGRDbGFzcyhuYW1lc3BhY2lmeSgnb3ZlcmxheScpICsgJyAnICsgbmFtZXNwYWNpZnkoJ2lzJywgU1RBVEVTLkNMT1NFRCkpLmhpZGUoKTtcclxuICAgICAgJGFwcGVuZFRvLmFwcGVuZChyZW1vZGFsLiRvdmVybGF5KTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vZGFsLiRiZyA9ICQoJy4nICsgbmFtZXNwYWNpZnkoJ2JnJykpLmFkZENsYXNzKG5hbWVzcGFjaWZ5KCdpcycsIFNUQVRFUy5DTE9TRUQpKTtcclxuXHJcbiAgICByZW1vZGFsLiRtb2RhbCA9ICRtb2RhbFxyXG4gICAgICAuYWRkQ2xhc3MoXHJcbiAgICAgICAgTkFNRVNQQUNFICsgJyAnICtcclxuICAgICAgICBuYW1lc3BhY2lmeSgnaXMtaW5pdGlhbGl6ZWQnKSArICcgJyArXHJcbiAgICAgICAgcmVtb2RhbC5zZXR0aW5ncy5tb2RpZmllciArICcgJyArXHJcbiAgICAgICAgbmFtZXNwYWNpZnkoJ2lzJywgU1RBVEVTLkNMT1NFRCkpXHJcbiAgICAgIC5hdHRyKCd0YWJpbmRleCcsICctMScpO1xyXG5cclxuICAgIHJlbW9kYWwuJHdyYXBwZXIgPSAkKCc8ZGl2PicpXHJcbiAgICAgIC5hZGRDbGFzcyhcclxuICAgICAgICBuYW1lc3BhY2lmeSgnd3JhcHBlcicpICsgJyAnICtcclxuICAgICAgICByZW1vZGFsLnNldHRpbmdzLm1vZGlmaWVyICsgJyAnICtcclxuICAgICAgICBuYW1lc3BhY2lmeSgnaXMnLCBTVEFURVMuQ0xPU0VEKSlcclxuICAgICAgLmhpZGUoKVxyXG4gICAgICAuYXBwZW5kKHJlbW9kYWwuJG1vZGFsKTtcclxuICAgICRhcHBlbmRUby5hcHBlbmQocmVtb2RhbC4kd3JhcHBlcik7XHJcblxyXG4gICAgLy8gQWRkIHRoZSBldmVudCBsaXN0ZW5lciBmb3IgdGhlIGNsb3NlIGJ1dHRvblxyXG4gICAgcmVtb2RhbC4kd3JhcHBlci5vbignY2xpY2suJyArIE5BTUVTUEFDRSwgJ1tkYXRhLScgKyBQTFVHSU5fTkFNRSArICctYWN0aW9uPVwiY2xvc2VcIl0nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgIHJlbW9kYWwuY2xvc2UoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEFkZCB0aGUgZXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBjYW5jZWwgYnV0dG9uXHJcbiAgICByZW1vZGFsLiR3cmFwcGVyLm9uKCdjbGljay4nICsgTkFNRVNQQUNFLCAnW2RhdGEtJyArIFBMVUdJTl9OQU1FICsgJy1hY3Rpb249XCJjYW5jZWxcIl0nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgIHJlbW9kYWwuJG1vZGFsLnRyaWdnZXIoU1RBVEVfQ0hBTkdFX1JFQVNPTlMuQ0FOQ0VMTEFUSU9OKTtcclxuXHJcbiAgICAgIGlmIChyZW1vZGFsLnNldHRpbmdzLmNsb3NlT25DYW5jZWwpIHtcclxuICAgICAgICByZW1vZGFsLmNsb3NlKFNUQVRFX0NIQU5HRV9SRUFTT05TLkNBTkNFTExBVElPTik7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEFkZCB0aGUgZXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBjb25maXJtIGJ1dHRvblxyXG4gICAgcmVtb2RhbC4kd3JhcHBlci5vbignY2xpY2suJyArIE5BTUVTUEFDRSwgJ1tkYXRhLScgKyBQTFVHSU5fTkFNRSArICctYWN0aW9uPVwiY29uZmlybVwiXScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgcmVtb2RhbC4kbW9kYWwudHJpZ2dlcihTVEFURV9DSEFOR0VfUkVBU09OUy5DT05GSVJNQVRJT04pO1xyXG5cclxuICAgICAgaWYgKHJlbW9kYWwuc2V0dGluZ3MuY2xvc2VPbkNvbmZpcm0pIHtcclxuICAgICAgICByZW1vZGFsLmNsb3NlKFNUQVRFX0NIQU5HRV9SRUFTT05TLkNPTkZJUk1BVElPTik7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEFkZCB0aGUgZXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBvdmVybGF5XHJcbiAgICByZW1vZGFsLiR3cmFwcGVyLm9uKCdjbGljay4nICsgTkFNRVNQQUNFLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciAkdGFyZ2V0ID0gJChlLnRhcmdldCk7XHJcblxyXG4gICAgICBpZiAoISR0YXJnZXQuaGFzQ2xhc3MobmFtZXNwYWNpZnkoJ3dyYXBwZXInKSkpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChyZW1vZGFsLnNldHRpbmdzLmNsb3NlT25PdXRzaWRlQ2xpY2spIHtcclxuICAgICAgICByZW1vZGFsLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogT3BlbnMgYSBtb2RhbCB3aW5kb3dcclxuICAgKiBAcHVibGljXHJcbiAgICovXHJcbiAgUmVtb2RhbC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHJlbW9kYWwgPSB0aGlzO1xyXG4gICAgdmFyIGlkO1xyXG5cclxuICAgIC8vIENoZWNrIGlmIHRoZSBhbmltYXRpb24gd2FzIGNvbXBsZXRlZFxyXG4gICAgaWYgKHJlbW9kYWwuc3RhdGUgPT09IFNUQVRFUy5PUEVOSU5HIHx8IHJlbW9kYWwuc3RhdGUgPT09IFNUQVRFUy5DTE9TSU5HKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBpZCA9IHJlbW9kYWwuJG1vZGFsLmF0dHIoJ2RhdGEtJyArIFBMVUdJTl9OQU1FICsgJy1pZCcpO1xyXG5cclxuICAgIGlmIChpZCAmJiByZW1vZGFsLnNldHRpbmdzLmhhc2hUcmFja2luZykge1xyXG4gICAgICBzY3JvbGxUb3AgPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7XHJcbiAgICAgIGxvY2F0aW9uLmhhc2ggPSBpZDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoY3VycmVudCAmJiBjdXJyZW50ICE9PSByZW1vZGFsKSB7XHJcbiAgICAgIGhhbHQoY3VycmVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgY3VycmVudCA9IHJlbW9kYWw7XHJcbiAgICBsb2NrU2NyZWVuKCk7XHJcbiAgICByZW1vZGFsLiRiZy5hZGRDbGFzcyhyZW1vZGFsLnNldHRpbmdzLm1vZGlmaWVyKTtcclxuICAgIHJlbW9kYWwuJG92ZXJsYXkuYWRkQ2xhc3MocmVtb2RhbC5zZXR0aW5ncy5tb2RpZmllcikuc2hvdygpO1xyXG4gICAgcmVtb2RhbC4kd3JhcHBlci5zaG93KCkuc2Nyb2xsVG9wKDApO1xyXG4gICAgLy9yZW1vZGFsLiRtb2RhbC5mb2N1cygpO1xyXG5cclxuICAgIHN5bmNXaXRoQW5pbWF0aW9uKFxyXG4gICAgICBmdW5jdGlvbigpIHtcclxuICAgICAgICBzZXRTdGF0ZShyZW1vZGFsLCBTVEFURVMuT1BFTklORyk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBmdW5jdGlvbigpIHtcclxuICAgICAgICBzZXRTdGF0ZShyZW1vZGFsLCBTVEFURVMuT1BFTkVEKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHJlbW9kYWwpO1xyXG4gIH07XHJcblxyXG4gIC8qKlxyXG4gICAqIENsb3NlcyBhIG1vZGFsIHdpbmRvd1xyXG4gICAqIEBwdWJsaWNcclxuICAgKiBAcGFyYW0ge1N0cmluZ30gcmVhc29uXHJcbiAgICovXHJcbiAgUmVtb2RhbC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbihyZWFzb24pIHtcclxuICAgIHZhciByZW1vZGFsID0gdGhpcztcclxuXHJcbiAgICAvLyBDaGVjayBpZiB0aGUgYW5pbWF0aW9uIHdhcyBjb21wbGV0ZWRcclxuICAgIGlmIChyZW1vZGFsLnN0YXRlID09PSBTVEFURVMuT1BFTklORyB8fCByZW1vZGFsLnN0YXRlID09PSBTVEFURVMuQ0xPU0lORykge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKFxyXG4gICAgICByZW1vZGFsLnNldHRpbmdzLmhhc2hUcmFja2luZyAmJlxyXG4gICAgICByZW1vZGFsLiRtb2RhbC5hdHRyKCdkYXRhLScgKyBQTFVHSU5fTkFNRSArICctaWQnKSA9PT0gbG9jYXRpb24uaGFzaC5zdWJzdHIoMSlcclxuICAgICkge1xyXG4gICAgICBsb2NhdGlvbi5oYXNoID0gJyc7XHJcbiAgICAgICQod2luZG93KS5zY3JvbGxUb3Aoc2Nyb2xsVG9wKTtcclxuICAgIH1cclxuXHJcbiAgICBzeW5jV2l0aEFuaW1hdGlvbihcclxuICAgICAgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgc2V0U3RhdGUocmVtb2RhbCwgU1RBVEVTLkNMT1NJTkcsIGZhbHNlLCByZWFzb24pO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmVtb2RhbC4kYmcucmVtb3ZlQ2xhc3MocmVtb2RhbC5zZXR0aW5ncy5tb2RpZmllcik7XHJcbiAgICAgICAgcmVtb2RhbC4kb3ZlcmxheS5yZW1vdmVDbGFzcyhyZW1vZGFsLnNldHRpbmdzLm1vZGlmaWVyKS5oaWRlKCk7XHJcbiAgICAgICAgcmVtb2RhbC4kd3JhcHBlci5oaWRlKCk7XHJcbiAgICAgICAgdW5sb2NrU2NyZWVuKCk7XHJcblxyXG4gICAgICAgIHNldFN0YXRlKHJlbW9kYWwsIFNUQVRFUy5DTE9TRUQsIGZhbHNlLCByZWFzb24pO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgcmVtb2RhbCk7XHJcbiAgfTtcclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyBhIGN1cnJlbnQgc3RhdGUgb2YgYSBtb2RhbFxyXG4gICAqIEBwdWJsaWNcclxuICAgKiBAcmV0dXJucyB7U1RBVEVTfVxyXG4gICAqL1xyXG4gIFJlbW9kYWwucHJvdG90eXBlLmdldFN0YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5zdGF0ZTtcclxuICB9O1xyXG5cclxuICAvKipcclxuICAgKiBEZXN0cm95cyBhIG1vZGFsXHJcbiAgICogQHB1YmxpY1xyXG4gICAqL1xyXG4gIFJlbW9kYWwucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBsb29rdXAgPSAkW1BMVUdJTl9OQU1FXS5sb29rdXA7XHJcbiAgICB2YXIgaW5zdGFuY2VDb3VudDtcclxuXHJcbiAgICBoYWx0KHRoaXMpO1xyXG4gICAgdGhpcy4kd3JhcHBlci5yZW1vdmUoKTtcclxuXHJcbiAgICBkZWxldGUgbG9va3VwW3RoaXMuaW5kZXhdO1xyXG4gICAgaW5zdGFuY2VDb3VudCA9ICQuZ3JlcChsb29rdXAsIGZ1bmN0aW9uKGluc3RhbmNlKSB7XHJcbiAgICAgIHJldHVybiAhIWluc3RhbmNlO1xyXG4gICAgfSkubGVuZ3RoO1xyXG5cclxuICAgIGlmIChpbnN0YW5jZUNvdW50ID09PSAwKSB7XHJcbiAgICAgIHRoaXMuJG92ZXJsYXkucmVtb3ZlKCk7XHJcbiAgICAgIHRoaXMuJGJnLnJlbW92ZUNsYXNzKFxyXG4gICAgICAgIG5hbWVzcGFjaWZ5KCdpcycsIFNUQVRFUy5DTE9TSU5HKSArICcgJyArXHJcbiAgICAgICAgbmFtZXNwYWNpZnkoJ2lzJywgU1RBVEVTLk9QRU5JTkcpICsgJyAnICtcclxuICAgICAgICBuYW1lc3BhY2lmeSgnaXMnLCBTVEFURVMuQ0xPU0VEKSArICcgJyArXHJcbiAgICAgICAgbmFtZXNwYWNpZnkoJ2lzJywgU1RBVEVTLk9QRU5FRCkpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIC8qKlxyXG4gICAqIFNwZWNpYWwgcGx1Z2luIG9iamVjdCBmb3IgaW5zdGFuY2VzXHJcbiAgICogQHB1YmxpY1xyXG4gICAqIEB0eXBlIHtPYmplY3R9XHJcbiAgICovXHJcbiAgJFtQTFVHSU5fTkFNRV0gPSB7XHJcbiAgICBsb29rdXA6IFtdXHJcbiAgfTtcclxuXHJcbiAgLyoqXHJcbiAgICogUGx1Z2luIGNvbnN0cnVjdG9yXHJcbiAgICogQGNvbnN0cnVjdG9yXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcclxuICAgKiBAcmV0dXJucyB7SlF1ZXJ5fVxyXG4gICAqL1xyXG4gICQuZm5bUExVR0lOX05BTUVdID0gZnVuY3Rpb24ob3B0cykge1xyXG4gICAgdmFyIGluc3RhbmNlO1xyXG4gICAgdmFyICRlbGVtO1xyXG5cclxuICAgIHRoaXMuZWFjaChmdW5jdGlvbihpbmRleCwgZWxlbSkge1xyXG4gICAgICAkZWxlbSA9ICQoZWxlbSk7XHJcblxyXG4gICAgICBpZiAoJGVsZW0uZGF0YShQTFVHSU5fTkFNRSkgPT0gbnVsbCkge1xyXG4gICAgICAgIGluc3RhbmNlID0gbmV3IFJlbW9kYWwoJGVsZW0sIG9wdHMpO1xyXG4gICAgICAgICRlbGVtLmRhdGEoUExVR0lOX05BTUUsIGluc3RhbmNlLmluZGV4KTtcclxuXHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgaW5zdGFuY2Uuc2V0dGluZ3MuaGFzaFRyYWNraW5nICYmXHJcbiAgICAgICAgICAkZWxlbS5hdHRyKCdkYXRhLScgKyBQTFVHSU5fTkFNRSArICctaWQnKSA9PT0gbG9jYXRpb24uaGFzaC5zdWJzdHIoMSlcclxuICAgICAgICApIHtcclxuICAgICAgICAgIGluc3RhbmNlLm9wZW4oKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaW5zdGFuY2UgPSAkW1BMVUdJTl9OQU1FXS5sb29rdXBbJGVsZW0uZGF0YShQTFVHSU5fTkFNRSldO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gaW5zdGFuY2U7XHJcbiAgfTtcclxuXHJcbiAgJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgLy8gZGF0YS1yZW1vZGFsLXRhcmdldCBvcGVucyBhIG1vZGFsIHdpbmRvdyB3aXRoIHRoZSBzcGVjaWFsIElkXHJcbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnW2RhdGEtJyArIFBMVUdJTl9OQU1FICsgJy10YXJnZXRdJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICB2YXIgZWxlbSA9IGUuY3VycmVudFRhcmdldDtcclxuICAgICAgdmFyIGlkID0gZWxlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtJyArIFBMVUdJTl9OQU1FICsgJy10YXJnZXQnKTtcclxuICAgICAgdmFyICR0YXJnZXQgPSAkKCdbZGF0YS0nICsgUExVR0lOX05BTUUgKyAnLWlkPVwiJyArIGlkICsgJ1wiXScpO1xyXG5cclxuICAgICAgJFtQTFVHSU5fTkFNRV0ubG9va3VwWyR0YXJnZXQuZGF0YShQTFVHSU5fTkFNRSldLm9wZW4oKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEF1dG8gaW5pdGlhbGl6YXRpb24gb2YgbW9kYWwgd2luZG93c1xyXG4gICAgLy8gVGhleSBzaG91bGQgaGF2ZSB0aGUgJ3JlbW9kYWwnIGNsYXNzIGF0dHJpYnV0ZVxyXG4gICAgLy8gQWxzbyB5b3UgY2FuIHdyaXRlIHRoZSBgZGF0YS1yZW1vZGFsLW9wdGlvbnNgIGF0dHJpYnV0ZSB0byBwYXNzIHBhcmFtcyBpbnRvIHRoZSBtb2RhbFxyXG4gICAgJChkb2N1bWVudCkuZmluZCgnLicgKyBOQU1FU1BBQ0UpLmVhY2goZnVuY3Rpb24oaSwgY29udGFpbmVyKSB7XHJcbiAgICAgIHZhciAkY29udGFpbmVyID0gJChjb250YWluZXIpO1xyXG4gICAgICB2YXIgb3B0aW9ucyA9ICRjb250YWluZXIuZGF0YShQTFVHSU5fTkFNRSArICctb3B0aW9ucycpO1xyXG5cclxuICAgICAgaWYgKCFvcHRpb25zKSB7XHJcbiAgICAgICAgb3B0aW9ucyA9IHt9O1xyXG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnc3RyaW5nJyB8fCBvcHRpb25zIGluc3RhbmNlb2YgU3RyaW5nKSB7XHJcbiAgICAgICAgb3B0aW9ucyA9IHBhcnNlT3B0aW9ucyhvcHRpb25zKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgJGNvbnRhaW5lcltQTFVHSU5fTkFNRV0ob3B0aW9ucyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBIYW5kbGVzIHRoZSBrZXlkb3duIGV2ZW50XHJcbiAgICAkKGRvY3VtZW50KS5vbigna2V5ZG93bi4nICsgTkFNRVNQQUNFLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGlmIChjdXJyZW50ICYmIGN1cnJlbnQuc2V0dGluZ3MuY2xvc2VPbkVzY2FwZSAmJiBjdXJyZW50LnN0YXRlID09PSBTVEFURVMuT1BFTkVEICYmIGUua2V5Q29kZSA9PT0gMjcpIHtcclxuICAgICAgICBjdXJyZW50LmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEhhbmRsZXMgdGhlIGhhc2hjaGFuZ2UgZXZlbnRcclxuICAgICQod2luZG93KS5vbignaGFzaGNoYW5nZS4nICsgTkFNRVNQQUNFLCBoYW5kbGVIYXNoQ2hhbmdlRXZlbnQpO1xyXG4gIH0pO1xyXG59KTtcclxuIl19
